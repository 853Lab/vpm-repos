name: Publish a Package Version to vpm

on:
  repository_dispatch:
    types: [publish-vpm]

# Sets permissions of the GITHUB_TOKEN to allow deployment to GitHub Pages
permissions:
  contents: write

jobs:
  publishVpm:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Checkout package repository
        uses: actions/checkout@v4
        with:
          # repository: github.repository
          # path: github.event.repository.name
          # name: name without .zip
          # version: publish version
          repository: ${{ github.event.client_payload.repository }}
          path: ${{ github.event.client_payload.path }}

      - name: Install Deno
        uses: denoland/setup-deno@v1
        with:
          deno-version: vx.x.x

      - name: Run Deno script
        run: deno run ./vpmUpdater/vpmupdater.ts ${{ github.event.client_payload.repository }} ${{ github.event.client_payload.path }} ${{ github.event.client_payload.name }} ${{ github.event.client_payload.version }}